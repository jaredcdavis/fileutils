<!HTML>
<html>
<head>
<meta charset="UTF-8">

<!--
Fileutils -- A Common Lisp File Utilities Library
Copyright (C) 2014 Kookamara LLC

Contact:

  Kookamara LLC
  11410 Windermere Meadows
  Austin, TX 78759, USA
  http://www.kookamara.com/

License: (An MIT/X11-style license)

  Permission is hereby granted, free of charge, to any person obtaining a
  copy of this software and associated documentation files (the "Software"),
  to deal in the Software without restriction, including without limitation
  the rights to use, copy, modify, merge, publish, distribute, sublicense,
  and/or sell copies of the Software, and to permit persons to whom the
  Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
  DEALINGS IN THE SOFTWARE.

Original author: Jared Davis <jared@kookamara.com>
-->

<title>Fileutils &mdash; Common Lisp File Utilities Library</title>
<link rel="stylesheet" type="text/css" href="style.css"/>
</head>

<body>

<h1>Fileutils Library</h1>

<p>Fileutils is a library of file-system related functions for Common Lisp.  It
is meant to be portable across Unix-like and Windows file systems and across
Lisp implementations.</p>

<p>Fileutils avoids the Common Lisp <i>pathname</i> functionality (which
differs across Lisp implementations), and instead provides an API where paths
are represented as ordinary strings.</p>


<h2>Installation</h2>

<p>Note: Installation instructions are not covered here.  Instead, see
BOZO.</p>


<h2><a name="definitions">Definitions</a></h2>

<h5><a name="vanillapath">Vanilla Path</a></h5>

<p>Many Fileutils functions accept <b>vanilla path</b> arguments.  A vanilla
path is an ordinary Common Lisp strings that should generally indicate a single
file or directory.</p>

<p>Characters like <b>*</b> and <b>?</b>, which are given special
interpretation in many shells, have no special meaning in vanilla paths.  That
is, a vanilla path such as <tt>"foo/*.txt"</tt> does <b>not</b> refer to all of
the files in <tt>foo/</tt> that end with <tt>.txt</tt>; instead, it refers to a
single file whose name might have to be written using quotes
like <tt>'foo/*.txt'</tt> to avoid wildcard expansion in most shells.</p>

<p>The <b>~</b> character, which expands to user home directories on most
shells, also has no special meaning in a vanilla path.  That is, a vanilla path
such as <tt>"~jared/foo.txt"</tt> does not refer to <tt>foo.txt</tt> in my home
directory, but instead referse to a single file whose name might be written at
the terminal as <tt>'./~jared/foo.txt'</tt>.</p>



<h2><a name="pathname">Path Name Functions</a></h2>

<div class="fn">
<h5><a name="absolute-path-p">(absolute-path-p path) &rarr; bool</a></h5>

<p>The <tt>path</tt> is a <a href="#vanillapath">vanilla path</a>.  We check
whether it is an absolute path, returning the answer as <tt>t</tt>
or <tt>nil</tt>.  On Unix-like systems this essentially just means the path
starts with a <tt>/</tt> character.  On Windows it means the path begins with a
drive letter like <tt>c:\</tt> or a share name like <tt>\\mediabox\movies</tt>.
See also <a href="#relative-path-p">relative-path-p</a>.</p>

<div class="examples">
<p>Examples (Unix-like systems):</p>
<pre>
 (absolute-path-p "/usr/bin/banana") ;; t
 (absolute-path-p "books")           ;; nil
</pre>

<p>Examples (Windows systems):</p>
<pre>
 (absolute-path-p "c:\\windows") ;; t
 (absolute-path-p "books")       ;; nil
</pre>
</div>

<p>This is entirely a string-based check that does not consult the file system,
network, etc.  Accordingly, whether a path is absolute or relative says nothing
about whether it exists, can be read or written, etc.</p>
</div>


<div class="fn">
<h5>(path-exists-p path) &rarr; bool</h5>

<p>The <tt>path</tt> is a <a href="#vanillapath">vanilla path</a>.  We check
whether <tt>path</tt> exists on the current file system.  See
also <a href="#path-type">path-type</a>.</p>

<div class="examples">
<p>Examples (Unix-like systems):</p>
<pre>
 (path-exists-p "/usr/bin/")        ;; probably t
 (path-exists-p "newt-recipes.txt") ;; probably nil
</pre>

<p>Examples (Windows systems):</p>
<pre>
 (path-exists-p "c:\\windows")                ;; probably t
 (path-exists-p "books\\snake-wrangling.pdf") ;; probably nil
</pre>
</div>

<p>Whether a path exists says nothing about what kind of path it is.  For
instance, on a Unix-like system, <tt>path-exists-p</tt> will return true for
ordinary files, directories, special devices like <tt>"/dev/null"</tt>, and
esoteric files like sockets and pipes.  Moreover, we say that symbolic links
exist even when they are broken.</p>


</div>

<div class="fn">
<h5>(path-to-lisp path) &rarr; lisp-pathname</h5>

<p>The <tt>path</tt> is a <a href="#vanillapath">vanilla path</a>.  We create,
from <tt>path</tt>, a corresponding Common Lisp
<a href="http://www.lispworks.com/documentation/lw50/CLHS/Body/19_b.htm">pathname object</a>.</p>

<p>Many Common Lisp functions, such as <tt>open</tt> and <tt>compile-file</tt>,
take <i>pathspec</i> arguments which are either pathnames or strings.  These
path names are normally constructed with functions like

Common Lisp's
<a href='http://www.lispworks.com/documentation/lw50/CLHS/Body/f_pn.htm'>pathname</a>,

or Lisp-specific variants such as
CCL's
<a href='http://ccl.clozure.com/ccl-documentation.html#f_native-translated-namestring'>ccl:native-translated-namestring</a>,

CMUCL's <tt>ext:unix-namestring</tt>, or

SBCL's <a href="http://sbcl.org/manual/index.html#Native-Filenames">parse-native-namestring</a>, etc., or

with wrapper libraries like <tt>uiop:parse-native-namestring</tt>.  These
approaches are generally implementation dependent.  They especially vary around
the edge-cases, e.g., characters like <tt>~</tt>, <tt>:</tt>, <tt>*</tt>,
etc.</p>

<p>The goal of <tt>path-to-lisp</tt> is to avoid all of this and to provide a
consistent way to interpret vanilla paths for all Lisps on the same platform
(e.g., Unix-like systems or Windows).</p>

<p>The <tt>pathname</tt> object that is created by <tt>path-to-lisp</tt> can
then given to functions like <tt>open</tt>.</p>
</div>



<div class="fn">
<h5>(path-type path [:follow-symlinks bool]) &rarr; kind</h5>

<p>The <tt>path</tt> is a <a href="#vanillapath">vanilla path</a>.  We
determine what kind of path it is and return a symbol.  The possible return
values are listed in the constant <tt>+path-kinds+</tt>.</p>


<div class="examples">
<p>Examples (Unix-like systems):</p>
<pre>
 (path-type "/usr/local/bin")  ;; :directory
 (path-type "/bin/ls")         ;; :regular-file
</pre>
</div>

<p>BOZO explain what can happen, how symlinks are handled, meaning of symbolic
links.</p>

</div>




<div class="fn">
<h5><a name="relative-path-p">(relative-path-p path) &rarr; bool</a></h5>

<p>The <tt>path</tt> is a <a href="#vanillapath">vanilla path</a>.  We check
whether it is an absolute path, returning the answer as <tt>t</tt>
or <tt>nil</tt>.</p>

<div class="examples">
<p>Examples (Unix-like systems):</p>

<pre>
 (relative-path-p "/usr/local/bin")  ;; nil
 (relative-path-p "books/spec.pdf")  ;; t
</pre>

<p>Examples (Windows systems):</p>

<pre>
 (relative-path-p "c:\\windows")  ;; nil
 (relative-path-p "games\\quake") ;; t
</pre>
</div>

<p>This is just the opposite
of <a href="#absolute-path-p">absolute-path-p</a>; see its description
for more details.</p>
</div>


</body>
</html>


